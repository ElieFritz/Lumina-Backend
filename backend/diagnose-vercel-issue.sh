#!/bin/bash

echo "üîç Diagnostic Vercel - Probl√®me de Routing"
echo "=========================================="

echo "üìã Probl√®me identifi√© :"
echo "Vercel retourne 'The page could not be found' pour toutes les routes"
echo "Cela indique un probl√®me de configuration ou de build"
echo ""

echo "üîß Solutions √† essayer :"
echo ""
echo "1. **V√©rifiez les logs de build dans Vercel :**"
echo "   - Allez sur https://vercel.com/dashboard"
echo "   - S√©lectionnez votre projet"
echo "   - Onglet 'Deployments'"
echo "   - Cliquez sur le dernier d√©ploiement"
echo "   - V√©rifiez les logs de build"
echo ""

echo "2. **V√©rifiez la configuration du projet :**"
echo "   - Root Directory: backend"
echo "   - Build Command: npm run build"
echo "   - Output Directory: dist"
echo "   - Install Command: npm install"
echo ""

echo "3. **Variables d'environnement requises :**"
echo "   NODE_ENV=production"
echo "   DATABASE_URL=postgresql://postgres.baoywgzpmndrbiagiczs:Eliefritz97@aws-1-ca-central-1.pooler.supabase.com:6543/postgres"
echo "   NEXT_PUBLIC_SUPABASE_URL=https://baoywgzpmndrbiagiczs.supabase.co"
echo "   NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
echo "   FRONTEND_URL=https://lumina-africa-frontend.vercel.app"
echo ""

echo "4. **Solution alternative - Cr√©er un nouveau projet :**"
echo "   - Supprimez le projet actuel"
echo "   - Cr√©ez un nouveau projet"
echo "   - Importez le repository"
echo "   - Configurez avec les param√®tres ci-dessus"
echo ""

echo "5. **Test de l'API localement :**"
echo "   cd /Users/macmiui/lumina/Lumina/backend"
echo "   npm run build"
echo "   node dist/main.js"
echo "   curl http://localhost:10000/api/health"
echo ""

echo "üìä Configuration actuelle :"
echo "- vercel.json : ‚úÖ Configur√©"
echo "- api/index.js : ‚úÖ Handler Express + NestJS"
echo "- dist/ : ‚úÖ Fichiers compil√©s pr√©sents"
echo "- package.json : ‚úÖ D√©pendances install√©es"
echo ""

echo "üéØ Prochaines √©tapes :"
echo "1. V√©rifiez les logs Vercel"
echo "2. Si n√©cessaire, cr√©ez un nouveau projet"
echo "3. Testez l'API localement"
echo "4. Red√©ployez avec la bonne configuration"
echo ""

echo "üîó Liens utiles :"
echo "- Dashboard Vercel: https://vercel.com/dashboard"
echo "- Repository: https://github.com/ElieFritz/Lumina"
echo "- API locale: http://localhost:10000/api/health"
